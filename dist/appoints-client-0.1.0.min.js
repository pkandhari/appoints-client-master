angular.module("appoints.appointment",["ngRoute"]).controller("AppointmentCtrl",["$scope","_","flash","moment","config","$location","$routeParams","$http",function(e,t,n,a,o,r,i,s){e.doctor={},e.isreadonly="true"===i.isreadonly,e.getEndTime=function(e){return a(e.dateAndTime).add(e.duration,"minutes").format("H:mm")},e.updateAppointment=function(){e.editAppointment.doctorId=e.doctor.DoctorId;var t=o.apiEndpoint+"/appointments",a={method:"PUT",url:t,data:e.editAppointment};return s(a).then(function(){n.add("Appointment updated successfully","info"),r.url("/dashboard")},function(e){n.add(e.data.ExceptionMessage,"error")})},e.getAppointment=function(){e.appointmentId=1;var t={method:"GET",url:o.apiEndpoint+"/appointments/"+i.appointmentid};return s(t).then(function(t){e.editAppointment=t.data,e.editAppointment.DateAndTime=a(e.editAppointment.DateAndTime),e.doctor.DoctorId=e.editAppointment.DoctorId},function(e){n.add(e.data.ExceptionMessage,"error")})},e.getDoctors=function(){var t={method:"GET",url:o.apiEndpoint+"/doctors"};return s(t).then(function(t){e.doctors=t.data},function(e){n.add(e.data.ExceptionMessage,"error")})},e.goToDashboard=function(){r.url("/dashboard")},e.getAppointment(),e.getDoctors()}]),function(e){try{e=angular.module("appoints-client-templates")}catch(t){e=angular.module("appoints-client-templates",[])}e.run(["$templateCache",function(e){e.put("appointments/appointment.html",'<div ng-app="appoints" class="row"><div style="font-size: larger;padding-left: 1%"><a class="dropdown-toggle" role="button" title="Go to Dashboard" id="patient{{$index}}" href="" ng-click="goToDashboard()"><span class="glyphicon glyphicon-circle-arrow-left"></span>Go to dashboard</a></div><div class="col-md-6"><h2 style="text-align: center"><b>Appointment Details</b></h2><form role="form" name="form"><div class="form-group"><label for="doctor">Doctor</label><span class="mandatoryField" style="color: red">*</span><select class="form-control" id="doctor" ng-readonly="{{isreadonly}}" ng-options="doctor as doctor.UserDetails.FirstName for doctor in doctors track by doctor.DoctorId" ng-model="doctor" ng-change="optionChange()" required><option value="" disabled selected>Select your option</option></select></div><div class="form-group"><label for="title">Title</label><span class="mandatoryField" style="color: red">*</span> <input class="form-control" id="title" placeholder="Enter appointment description" ng-model="editAppointment.Title" ng-readonly="{{isreadonly}}" required></div><div class="form-group"><label for="dateAndTime">Appointment date and time</label><span class="mandatoryField" style="color: red">*</span><div class="dropdown"><a class="dropdown-toggle" id="dropdown1" role="button" data-toggle="dropdown"><div class="input-group"><input required data-date-time-input="MM/DD/YYYY HH:mm:ss" class="form-control" data-ng-model="editAppointment.DateAndTime" ng-readonly="{{isreadonly}}" required> <span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span></div></a><ul class="dropdown-menu" role="menu" aria-labelledby="dLabel"><datetimepicker data-ng-model="editAppointment.DateAndTime" ng-readonly="{{isreadonly}}" data-datetimepicker-config="{ dropdownSelector: \'#dropdown1\', startView: \'hour\', minuteStep: 15 }"></datetimepicker></ul></div></div><div class="form-group"><label for="duration">Duration</label><span class="mandatoryField" style="color: red">*</span><select class="form-control" id="duration" ng-model="editAppointment.Duration" ng-readonly="{{isreadonly}}" required><option value="15">15 minutes</option><option value="30">30 minutes</option><option value="60">60 minutes</option><option value="90">90 minutes</option></select></div><div class="form-group"><label for="remarks">Remarks</label><textarea id="remarks" class="form-control" rows="4" placeholder="Enter additional remarks" ng-model="editAppointment.Remarks"></textarea></div><button type="submit" class="btn btn-default" ng-click="updateAppointment()" ng-disabled="form.$invalid">Submit</button></form></div></div>')}])}(),function(e){try{e=angular.module("appoints-client-templates")}catch(t){e=angular.module("appoints-client-templates",[])}e.run(["$templateCache",function(e){e.put("appointments/CreateAppointment.html",'<div id="example" ng-app="appoints"><div class="col-md-4"><h2 style="text-align: center"><b>Create new appointment</b></h2><form role="form" name="form"><div class="form-group"><label for="doctor">Doctor</label><span class="mandatoryField" style="color: red">*</span><select class="form-control" id="doctor" ng-options="doctor as doctor.UserDetails.FirstName for doctor in doctors track by doctor.DoctorId" ng-model="doctor" ng-change="optionChange()" required><option value="" disabled selected>Select your option</option></select></div><div class="form-group"><label for="title">Title</label><span class="mandatoryField" style="color: red">*</span> <input class="form-control" id="title" placeholder="Enter appointment description" ng-model="newAppointment.title" required></div><div class="form-group"><label for="dateAndTime">Appointment date and time</label><span class="mandatoryField" style="color: red">*</span><div class="dropdown"><a class="dropdown-toggle" id="dropdown1" role="button" data-toggle="dropdown"><div class="input-group"><input required data-date-time-input="MM/DD/YYYY HH:mm:ss" class="form-control" data-ng-model="newAppointment.dateAndTime" required> <span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span></div></a><ul class="dropdown-menu" role="menu" aria-labelledby="dLabel"><datetimepicker data-ng-model="newAppointment.dateAndTime" data-datetimepicker-config="{ dropdownSelector: \'#dropdown1\', startView: \'hour\', minuteStep: 15 }"></datetimepicker></ul></div></div><div class="form-group"><label for="duration">Duration</label><span class="mandatoryField" style="color: red">*</span><select class="form-control" id="duration" ng-model="newAppointment.duration" required><option value="15">15 minutes</option><option value="30">30 minutes</option><option value="60">60 minutes</option><option value="90">90 minutes</option></select></div><div class="form-group"><label for="remarks">Remarks</label><textarea id="remarks" class="form-control" rows="4" placeholder="Enter additional remarks" ng-model="newAppointment.remarks"> </textarea></div><button type="submit" class="btn btn-default" ng-click="createAppointment()" ng-disabled="form.$invalid">Create</button></form></div><div class="col-md-8"><h2 style="text-align: center"><b>Doctor\'s Appointment Calendar</b></h2><div class="btn-toolbar"><div class="btn-group"><button class="btn btn-success" ng-click="changeView(\'agendaDay\', \'myCalendar\')">AgendaDay</button> <button class="btn btn-success" ng-click="changeView(\'agendaWeek\', \'myCalendar\')">AgendaWeek</button> <button class="btn btn-success" ng-click="changeView(\'month\', \'myCalendar\')">Month</button></div></div><div class="calendar" ng-model="eventSources" calendar="myCalendar" ui-calendar="uiConfig.calendar"></div></div></div>')}])}(),function(e){try{e=angular.module("appoints-client-templates")}catch(t){e=angular.module("appoints-client-templates",[])}e.run(["$templateCache",function(e){e.put("appointments/dashboard.html",'<div ng-app="appoints"><h1 style="text-align: center"><b>Welcome! {{user.displayName}}</b></h1><div class="col-md-4" ng-if="user.isAdmin"><h2><b>List of Doctors</b></h2><p ng-if="doctors.length === 0">-- None --</p><ul class="list-group"><li class="list-group-item" ng-repeat="doctor in doctors"><h4 class="list-group-item-heading"><a href="" ng-click="openDoctorDetails(doctor)"><b>{{doctor.UserDetails.FirstName}} {{doctor.UserDetails.LastName}}</b></a></h4><h5 class="list-group-item-heading">Graduated from: {{doctor.GraduatedFrom}}</h5><h5 class="list-group-item-heading">Practice: {{doctor.FieldOfPractice}}</h5><p class="list-group-item-text">{{doctor.CurrentWorkingStatus}}</p></li></ul></div><div class="col-md-4" ng-if="user.isAdmin"><h2><b>List of Patients</b></h2><p ng-if="patients.length === 0">-- None --</p><ul class="list-group"><li class="list-group-item" ng-repeat="patient in patients"><h4 class="list-group-item-heading"><a href="" ng-click="openPatientDetails(patient)"><b>{{patient.UserDetails.FirstName}} {{patient.UserDetails.LastName}}</b></a></h4><h5 class="list-group-item-heading">Health Issues: {{patient.HealthIssues}}</h5><h5 class="list-group-item-heading">Allergies: {{patient.Allergies}}</h5><p class="list-group-item-text">{{patient.CurrentWorkingStatus}}</p></li></ul></div><div class="col-md-4" ng-if="user.isAdmin"><h2><b>Upcoming Appointments</b></h2><p ng-if="upcomingAdminAppointments.length === 0">-- None --</p><ul class="list-group"><li class="list-group-item" ng-repeat="appointment in upcomingAdminAppointments"><h4 class="list-group-item-heading"><a href="" ng-click="openAppointment(appointment)"><b>{{appointment.Title}}</b></a></h4><h5 class="list-group-item-heading">{{appointment.DateAndTime | date:\'d MMM, y H:mm\'}}, duration: {{appointment.Duration}} mins</h5><h5 class="list-group-item-heading">Patient: <a href="" ng-click="openAppointmentPatient(appointment)">{{appointment.PatientName}}</a></h5><h5 class="list-group-item-heading">Doctor: <a href="" ng-click="openAppointmentDoctor(appointment)">{{appointment.DoctorName}}</a></h5><h5 class="list-group-item-heading">Remarks: {{appointment.Remarks}}</h5></li></ul><h2><b>Past Appointments</b></h2><p ng-if="pastAdminAppointments.length === 0">-- None --</p><ul class="list-group"><li class="list-group-item" ng-repeat="appointment in pastAdminAppointments"><h4 class="list-group-item-heading"><a href="" ng-click="openAppointment(appointment)"><b>{{appointment.Title}}</b></a></h4><h5 class="list-group-item-heading">{{appointment.DateAndTime | date:\'d MMM, y H:mm\'}}, duration: {{appointment.Duration}} mins</h5><h5 class="list-group-item-heading">Patient: <a href="" ng-click="openAppointmentPatient(appointment)">{{appointment.PatientName}}</a></h5><h5 class="list-group-item-heading">Doctor: <a href="" ng-click="openAppointmentDoctor(appointment)">{{appointment.DoctorName}}</a></h5><h5 class="list-group-item-heading">Remarks: {{appointment.Remarks}}</h5></li></ul></div><div class="col-md-4" ng-if="!user.isAdmin && user.isDoctor"><h2><b>Upcoming Appointments</b></h2><p ng-if="upcomingDoctorAppointments.length === 0">-- None --</p><ul class="list-group"><li class="list-group-item" ng-repeat="appointment in upcomingDoctorAppointments"><h4 class="list-group-item-heading"><a href="" ng-click="openAppointment(appointment)"><b>{{appointment.Title}}</b></a></h4><h5 class="list-group-item-heading">{{appointment.DateAndTime | date:\'d MMM, y H:mm\'}}, duration: {{appointment.Duration}} mins</h5><h5 class="list-group-item-heading">Patient: <a href="" ng-click="openAppointmentPatient(appointment)">{{appointment.PatientName}}</a></h5><h5 class="list-group-item-heading">Remarks: {{appointment.Remarks}}</h5></li></ul><h2><b>Past Appointments</b></h2><p ng-if="pastDoctorAppointments.length === 0">-- None --</p><ul class="list-group"><li class="list-group-item" ng-repeat="appointment in pastDoctorAppointments"><h4 class="list-group-item-heading"><a href="" ng-click="openAppointment(appointment)"><b>{{appointment.Title}}</b></a></h4><h5 class="list-group-item-heading">{{appointment.DateAndTime | date:\'d MMM, y H:mm\'}}, duration: {{appointment.Duration}} mins</h5><h5 class="list-group-item-heading">Patient: <a href="" ng-click="openAppointmentPatient(appointment)">{{appointment.PatientName}}</a></h5><h5 class="list-group-item-heading">Remarks: {{appointment.Remarks}}</h5></li></ul></div><div class="col-md-8" ng-if="!user.isAdmin && user.isDoctor"><h2 style="text-align: center"><b>Doctor\'s Appointment Calendar</b></h2><div class="btn-toolbar"><div class="btn-group"><button class="btn btn-success" ng-click="changeView(\'agendaDay\', \'myCalendar\')">AgendaDay</button> <button class="btn btn-success" ng-click="changeView(\'agendaWeek\', \'myCalendar\')">AgendaWeek</button> <button class="btn btn-success" ng-click="changeView(\'month\', \'myCalendar\')">Month</button></div></div><div class="calendar" ng-model="eventSourceDoctor" calendar="myCalendar" ui-calendar="uiConfig.calendar"></div></div><div class="col-md-4" ng-if="!user.isAdmin && !user.isDoctor"><h2><b>Upcoming appointments</b></h2><p ng-if="upcomingPatientAppointments.length === 0">-- None --</p><ul class="list-group"><li class="list-group-item" ng-repeat="appointment in upcomingPatientAppointments"><div><a href="" class="pull-right" ng-click="deleteAppointment(appointment)" title="Delete Appointment"><span class="glyphicon glyphicon-remove"></span></a></div><h4 class="list-group-item-heading"><a href="" ng-click="openAppointment(appointment)"><b>{{appointment.Title}}</b></a></h4><h5 class="list-group-item-heading">{{appointment.DateAndTime | date:\'d MMM, y H:mm\'}}, duration: {{appointment.Duration}} mins</h5><h5 class="list-group-item-heading">Doctor: <a href="" ng-click="openAppointmentDoctor(appointment)">{{appointment.DoctorName}}</a></h5><h5 class="list-group-item-heading">Remarks: {{appointment.Remarks}}</h5></li></ul><h2><b>Past appointments</b></h2><p ng-if="pastPatientAppointments.length === 0">-- None --</p><ul class="list-group"><li class="list-group-item" ng-repeat="appointment in pastPatientAppointments"><h4 class="list-group-item-heading"><a href="" ng-click="openAppointment(appointment)"><b>{{appointment.Title}}</b></a></h4><h5 class="list-group-item-heading">{{appointment.DateAndTime | date:\'d MMM, y H:mm\'}}, duration: {{appointment.Duration}} mins</h5><h5 class="list-group-item-heading">Doctor: <a href="" ng-click="openAppointmentDoctor(appointment)">{{appointment.DoctorName}}</a></h5><h5 class="list-group-item-heading">Remarks: {{appointment.Remarks}}</h5></li></ul></div><div class="col-md-8" ng-if="!user.isAdmin && !user.isDoctor"><h2 style="text-align: center"><b>Patient\'s Appointment Calendar</b></h2><div class="btn-toolbar"><div class="btn-group"><button class="btn btn-success" ng-click="changeView(\'agendaDay\', \'myCalendar\')">AgendaDay</button> <button class="btn btn-success" ng-click="changeView(\'agendaWeek\', \'myCalendar\')">AgendaWeek</button> <button class="btn btn-success" ng-click="changeView(\'month\', \'myCalendar\')">Month</button></div></div><div class="calendar" ng-model="eventSourcePatient" calendar="myCalendar" ui-calendar="uiConfig.calendar"></div></div></div>')}])}(),function(e){try{e=angular.module("appoints-client-templates")}catch(t){e=angular.module("appoints-client-templates",[])}e.run(["$templateCache",function(e){e.put("appointments/logindetails.html",'<div ng-app="appoints" class="col-md-6 col-md-offset-3"><h1 style="text-align: center;padding-bottom: 25px"><b>Update Login Details</b></h1><form name="form" ng-submit="vm.login()" role="form"><div class="form-group" ng-class="{ \'has-error\': form.oldPassword.$dirty && form.oldPassword.$error.required }"><label for="oldPassword">Old Password</label><span class="mandatoryField" style="color: red">*</span> <input type="password" name="oldPassword" id="oldPassword" class="form-control" ng-model="oldPassword" required> <span ng-show="form.oldPassword.$dirty && form.oldPassword.$error.required" class="help-block">Old password is required</span></div><div class="form-group" ng-class="{ \'has-error\': form.newPassword.$dirty && form.newPassword.$error.required }"><label for="newPassword">New Password</label><span class="mandatoryField" style="color: red">*</span> <input type="password" name="newPassword" id="newPassword" class="form-control" ng-model="newPassword" required> <span ng-show="form.newPassword.$dirty && form.newPassword.$error.required" class="help-block">New password is required</span></div><div class="form-actions"><button type="submit" ng-click="updatelogindetails()" ng-disabled="form.$invalid || vm.dataLoading" class="btn btn-primary">Submit</button> <a href="#/dashboard" class="btn btn-link">Cancel</a></div></form></div>')}])}(),function(e){try{e=angular.module("appoints-client-templates")}catch(t){e=angular.module("appoints-client-templates",[])}e.run(["$templateCache",function(e){e.put("appointments/profile.html",'<div class="" ng-app="appoints" ng-controller="ProfileCtrl"><div style="font-size: larger;padding-left: 5%" ng-if="isreadonly"><a class="dropdown-toggle" role="button" title="Go to Dashboard" id="patient{{$index}}" href="" ng-click="goToDashboard()"><span class="glyphicon glyphicon-circle-arrow-left"></span>Go to dashboard</a></div><h2 ng-if="!dataLoading" style="text-align: center">Details of: <b>{{profileData.UserDetails.FirstName}} {{profileData.UserDetails.LastName}}</b></h2><form name="form" ng-submit="register()" ng-if="!dataLoading" role="form"><div class="form-group col-md-12" style="padding-left: 15%;padding-right: 15%"><div class="form-group col-md-12" ng-class="{ \'has-error\': form.email.$dirty && (form.email.$error.required || form.email.$error.email) }"><label for="email">Email</label><span class="mandatoryField" style="color: red">*</span> <input type="email" name="email" id="email" class="form-control" ng-readonly="{{isreadonly}}" ng-model="profileData.UserDetails.Email" placeholder="Email" required> <span ng-show="form.email.$dirty && form.email.$error.email" class="help-block">This email format is invalid!</span> <span ng-show="form.email.$dirty && form.email.$error.required" class="help-block">Email is required</span></div></div><div class="form-group col-md-12" style="padding-left: 15%;padding-right: 15%"><div class="form-group col-md-6" ng-class="{ \'has-error\': form.firstName.$dirty && form.firstName.$error.required }"><label for="firstName">First name</label><span class="mandatoryField" style="color: red">*</span> <input name="firstName" id="firstName" class="form-control" ng-readonly="{{isreadonly}}" ng-model="profileData.UserDetails.FirstName" placeholder="First name" required> <span ng-show="form.firstName.$dirty && form.firstName.$error.required" class="help-block">First name is required</span></div><div class="form-group col-md-6" ng-class="{ \'has-error\': form.lastName.$dirty && form.lastName.$error.required }"><label for="lastName">Last name</label><span class="mandatoryField" style="color: red">*</span> <input name="lastName" id="lastName" class="form-control" ng-readonly="{{isreadonly}}" ng-model="profileData.UserDetails.LastName" placeholder="Last name" required> <span ng-show="form.lastName.$dirty && form.lastName.$error.required" class="help-block">Last name is required</span></div></div><div class="form-group col-md-12" style="padding-left: 15%;padding-right: 15%"><div class="form-group col-md-6"><label for="maritalStatus">Marital Status</label><select class="form-control" id="maritalStatus" ng-options="maritalStatus as maritalStatus.Description for maritalStatus in maritalStatusData track by maritalStatus.Id" ng-model="maritalStatus" required><option value="" disabled selected>Select your option</option></select></div><div class="form-group col-md-6"><label for="gender">Gender</label><select class="form-control" id="gender" ng-options="gender as gender.Description for gender in gendersData track by gender.Id" ng-model="gender" required><option value="" disabled selected>Select your option</option></select></div></div><div class="form-group col-md-12" style="padding-left: 15%;padding-right: 15%"><div class="form-group col-md-6"><label for="address">Address</label><input name="address" id="address" class="form-control" ng-readonly="{{isreadonly}}" ng-model="profileData.UserDetails.Address" placeholder="Address"></div><div class="form-group col-md-6"><label for="postalCode">Postal Code</label><input name="postalCode" id="postalCode" class="form-control" ng-readonly="{{isreadonly}}" ng-model="profileData.UserDetails.PostalCode" placeholder="Postal Code"></div></div><div class="form-group col-md-12" style="padding-left: 15%;padding-right: 15%"><div class="form-group col-md-6"><label for="city">City</label><input name="city" id="city" class="form-control" ng-readonly="{{isreadonly}}" ng-model="profileData.UserDetails.City" placeholder="City"></div><div class="form-group col-md-6"><label for="province">Province</label><input name="province" id="province" class="form-control" ng-readonly="{{isreadonly}}" ng-model="profileData.UserDetails.Province" placeholder="Province"></div></div><div class="form-group col-md-12" style="padding-left: 15%;padding-right: 15%"><div class="form-group col-md-6"><label for="country">Country</label><input name="country" id="country" class="form-control" ng-readonly="{{isreadonly}}" ng-model="profileData.UserDetails.Country" placeholder="Country"></div><div class="form-group col-md-6" ng-class="{ \'has-error\': form.contact.$dirty && form.contact.$invalid }"><label for="contact">Contact</label><input name="contact" id="contact" class="form-control" ng-readonly="{{isreadonly}}" ng-pattern="/\\d{3}-\\d{3}-\\d{4}/" ng-model="profileData.UserDetails.Contact" placeholder="Contact"> <span ng-show="form.contact.$dirty && form.contact.$invalid" class="help-block">This contact format is invalid! Valid format is XXX-XXX-XXXX</span></div></div><h2 style="text-align: center" ng-if="!profileData.UserDetails.IsAdmin && profileData.UserDetails.IsDoctor"><b>Doctor\'s Details</b></h2><div class="form-group col-md-12" style="padding-left: 15%;padding-right: 15%" ng-if="!profileData.UserDetails.IsAdmin && profileData.UserDetails.IsDoctor"><div class="form-group col-md-6"><label for="availability">Availability</label><input name="availability" id="availability" class="form-control" ng-readonly="{{isreadonly}}" ng-model="profileData.Availability" placeholder="Availability"></div><div class="form-group col-md-6"><label for="currentWorkingStatus">Current Working Status</label><input name="currentWorkingStatus" id="currentWorkingStatus" class="form-control" ng-readonly="{{isreadonly}}" ng-model="profileData.CurrentWorkingStatus" placeholder="Current Working Status"></div></div><div class="form-group col-md-12" style="padding-left: 15%;padding-right: 15%" ng-if="!profileData.UserDetails.IsAdmin && profileData.UserDetails.IsDoctor"><div class="form-group col-md-6"><label for="department">Department</label><input name="department" id="department" class="form-control" ng-readonly="{{isreadonly}}" ng-model="profileData.Department" placeholder="Department"></div><div class="form-group col-md-6"><label for="fieldOfPractice">Field of Practice</label><input name="fieldOfPractice" id="fieldOfPractice" class="form-control" ng-readonly="{{isreadonly}}" ng-model="profileData.FieldOfPractice" placeholder="Field of Practice"></div></div><div class="form-group col-md-12" style="padding-left: 15%;padding-right: 15%" ng-if="!profileData.UserDetails.IsAdmin && profileData.UserDetails.IsDoctor"><div class="form-group col-md-6"><label for="degree">Degree</label><input name="degree" id="degree" class="form-control" ng-readonly="{{isreadonly}}" ng-model="profileData.Degree" placeholder="Degree"></div><div class="form-group col-md-6"><label for="graduatedFrom">Graduated From</label><input name="graduatedFrom" id="graduatedFrom" class="form-control" ng-readonly="{{isreadonly}}" ng-model="profileData.GraduatedFrom" placeholder="Graduated From"></div></div><div class="form-group col-md-12" style="padding-left: 15%;padding-right: 15%" ng-if="!profileData.UserDetails.IsAdmin && profileData.UserDetails.IsDoctor"><div class="form-group col-md-6"><label for="dateOfJoining">Date of Joining</label><input name="dateOfJoining" id="dateOfJoining" class="form-control" ng-readonly="{{isreadonly}}" ng-model="profileData.DOJ" placeholder="Date of Joining"></div><div class="form-group col-md-6"><label for="yearsOfExp">Years of Experience</label><input name="yearsOfExp" id="yearsOfExp" class="form-control" ng-readonly="{{isreadonly}}" ng-model="profileData.YearsOfExp" placeholder="Years of Experience"></div></div><h2 style="text-align: center" ng-if="!profileData.UserDetails.IsAdmin && !profileData.UserDetails.IsDoctor"><b>Patient\'s Details</b></h2><div class="form-group col-md-12" style="padding-left: 15%;padding-right: 15%" ng-if="(!profileData.UserDetails.IsAdmin && !profileData.UserDetails.IsDoctor)"><div class="form-group col-md-6"><label for="allergies">Allergies</label><input name="allergies" id="allergies" class="form-control" ng-readonly="{{isreadonly}}" ng-model="profileData.Allergies" placeholder="Allergies"></div><div class="form-group col-md-6"><label for="healthIssues">Health Issues</label><input name="healthIssues" id="healthIssues" class="form-control" ng-readonly="{{isreadonly}}" ng-model="profileData.HealthIssues" placeholder="Health Issues"></div></div><div class="form-group col-md-12" ng-if="!isreadonly" style="padding-left: 15%;padding-right: 15%"><div class="form-actions col-md-6"><button type="submit" ng-click="saveProfileData()" ng-disabled="form.$invalid || dataLoading" class="btn btn-primary">Submit</button> <a href="#/dashboard" class="btn btn-link">Cancel</a></div></div></form></div>')}])}(),function(e){try{e=angular.module("appoints-client-templates")}catch(t){e=angular.module("appoints-client-templates",[])}e.run(["$templateCache",function(e){e.put("appointments/usersignin.html",'<div ng-app="appoints" class="col-md-6 col-md-offset-3"><h1 style="text-align: center;padding-bottom: 25px">Login to <b>DOC Connect</b></h1><form name="form" ng-submit="vm.login()" role="form"><div class="form-group" ng-class="{ \'has-error\': form.username.$dirty && form.username.$error.required }"><label for="username">Username</label><span class="mandatoryField" style="color: red">*</span> <input name="username" id="username" class="form-control" ng-model="username" required> <span ng-show="form.username.$dirty && form.username.$error.required" class="help-block">Username is required</span></div><div class="form-group" ng-class="{ \'has-error\': form.password.$dirty && form.password.$error.required }"><label for="password">Password</label><span class="mandatoryField" style="color: red">*</span> <input type="password" name="password" id="password" class="form-control" ng-model="password" required> <span ng-show="form.password.$dirty && form.password.$error.required" class="help-block">Password is required</span></div><div class="form-actions"><button type="submit" ng-click="login()" ng-disabled="form.$invalid || vm.dataLoading" class="btn btn-primary">Login</button> <a href="#/usersignup" class="btn btn-link">Signup</a></div></form></div>')}])}(),function(e){try{e=angular.module("appoints-client-templates")}catch(t){e=angular.module("appoints-client-templates",[])}e.run(["$templateCache",function(e){e.put("appointments/usersignup.html",'<div class="" ng-app="appoints"><h1 style="text-align: center;padding-bottom: 25px">Sign up your practice to <b>DOC Connect</b></h1><form name="form" ng-submit="vm.register()" role="form"><div class="form-group col-md-12" style="padding-left: 15%;padding-right: 15%"><div class="form-group col-md-12" ng-class="{ \'has-error\': form.email.$dirty && (form.email.$error.required || form.email.$error.email) }"><label for="username">Email</label><span class="mandatoryField" style="color: red">*</span> <input type="email" name="email" id="email" class="form-control" ng-model="signupObj.email" required> <span ng-show="form.email.$dirty && form.email.$error.email" class="help-block">This email format is invalid!</span> <span ng-show="form.email.$dirty && form.email.$error.required" class="help-block">Email is required</span></div></div><div class="form-group col-md-12" style="padding-left: 15%;padding-right: 15%"><div class="form-group col-md-6" ng-class="{ \'has-error\': form.firstName.$dirty && form.firstName.$error.required }"><label for="username">First name</label><span class="mandatoryField" style="color: red">*</span> <input name="firstName" id="firstName" class="form-control" ng-model="signupObj.firstName" required> <span ng-show="form.firstName.$dirty && form.firstName.$error.required" class="help-block">First name is required</span></div><div class="form-group col-md-6" ng-class="{ \'has-error\': form.lastName.$dirty && form.lastName.$error.required }"><label for="username">Last name</label><span class="mandatoryField" style="color: red">*</span> <input name="lastName" id="lastName" class="form-control" ng-model="signupObj.lastName" required> <span ng-show="form.lastName.$dirty && form.lastName.$error.required" class="help-block">Last name is required</span></div></div><div class="form-group col-md-12" style="padding-left: 15%;padding-right: 15%"><div class="form-group col-md-6" ng-class="{ \'has-error\': form.username.$dirty && form.username.$error.required }"><label for="username">Username</label><span class="mandatoryField" style="color: red">*</span> <input name="username" id="username" class="form-control" ng-model="signupObj.username" required> <span ng-show="form.username.$dirty && form.username.$error.required" class="help-block">Username is required</span></div><div class="form-group col-md-6" ng-class="{ \'has-error\': form.password.$dirty && form.password.$error.required }"><label for="password">Password</label><span class="mandatoryField" style="color: red">*</span> <input type="password" name="password" id="password" class="form-control" ng-model="signupObj.password" required> <span ng-show="form.password.$dirty && form.password.$error.required" class="help-block">Password is required</span></div></div><div class="form-check col-md-12" style="padding-left: 15%;padding-right: 15%"><div class="form-group col-md-6"><label for="isPractitioner">I am a practitioner</label><input type="checkbox" name="isPractitioner" id="isPractitioner" ng-model="signupObj.isPractitioner"></div></div><div class="form-group col-md-12" ng-show="signupObj.isPractitioner" style="padding-left: 15%;padding-right: 15%"><div class="form-group col-md-6"><label for="specialty">Your specialty</label><input name="specialty" id="specialty" class="form-control" ng-model="signupObj.specialty"> <small class="form-text text-muted"><i>"Dentistry", "Chiropractics"</i>, etc.</small></div><div class="form-group col-md-6"><label for="credentials">Credentials</label><input name="credentials" id="credentials" class="form-control" ng-model="signupObj.credentials"> <small class="form-text text-muted"><i>MD, BDS, DPM</i>, etc.</small></div></div><div class="form-group col-md-12" style="padding-left: 15%;padding-right: 15%"><div class="form-actions col-md-6"><button type="submit" ng-click="signup()" ng-disabled="form.$invalid || vm.dataLoading" class="btn btn-primary">Sign up</button> <a href="#/usersignin" class="btn btn-link">Cancel</a></div></div></form></div>')}])}(),function(e){try{e=angular.module("appoints-client-templates")}catch(t){e=angular.module("appoints-client-templates",[])}e.run(["$templateCache",function(e){e.put("home/home.html",'<div class="row"><div class="col-md-6" style="padding-top: 20px;font-family: cursive;font-size: 50px">A Good and healthy body is the reason behind a healthy mind.</div><div class="col-md-6"><img src="assets/images/image1.png"></div></div><div class="row"></div><footer class="pull-right">DOC Connect {{version}} - &copy; Pritpal Singh Kandhari, 2022</footer>')}])}(),function(e){try{e=angular.module("appoints-client-templates")}catch(t){e=angular.module("appoints-client-templates",[])}e.run(["$templateCache",function(e){e.put("shared/flash.html",'<section ng-controller="FlashCtrl" class="flashcontainer"><div ng-repeat="flashMessage in flashMessages" ng-class="getMessageClass(flashMessage.level)"><button type="button" class="close" data-dismiss="alert" ng-click="dismiss(flashMessage)">&times;</button> {{flashMessage.message}}<ul ng-if="flashMessage.details.errors"><li ng-repeat="error in flashMessage.details.errors">{{error.message}}</li></ul></div></section>')}])
}(),angular.module("ui.calendar",[]).constant("uiCalendarConfig",{calendars:{}}).controller("uiCalendarCtrl",["$scope","$locale","moment",function(e,t,n){var a=e.eventSources,o=e.calendarWatchEvent?e.calendarWatchEvent:angular.noop,r=function(t){return function(){if(e.$root.$$phase)return t.apply(this,arguments);var n=arguments,a=this;return e.$root.$apply(function(){return t.apply(a,n)})}},i=1;this.eventFingerprint=function(e){e._id||(e._id=i++);var t=o({event:e})||"",a=n.isMoment(e.start)?e.start.unix():e.start?n(e.start).unix():"",r=n.isMoment(e.end)?e.end.unix():e.end?n(e.end).unix():"";return[e._id,e.id||"",e.title||"",e.url||"",a,r,e.allDay||"",e.className||"",t].join("")};var s=1,l=1;this.sourceFingerprint=function(e){var t=""+(e.__id||(e.__id=s++)),n=angular.isObject(e)&&e.events;return n&&(t=t+"-"+(n.__id||(n.__id=l++))),t},this.allEvents=function(){return Array.prototype.concat.apply([],(a||[]).reduce(function(e,t){if(angular.isArray(t))e.push(t);else if(angular.isObject(t)&&angular.isArray(t.events)){var n=Object.keys(t).filter(function(e){return"_id"!==e&&"events"!==e});t.events.forEach(function(e){angular.extend(e,n)}),e.push(t.events)}return e},[]))},this.changeWatcher=function(e,t){var n,a=function(){return((angular.isFunction(e)?e():e)||[]).reduce(function(e,n){var a=t(n);return r[a]=n,e.push(a),e},[])},o=function(e,t){var n=(t||[]).reduce(function(e,t){return e[t]=!0,e},Object.create(null));return(e||[]).filter(function(e){return!n[e]})},r={},i=function(e,a){var i,s,l={},d=o(a,e);for(i=0;i<d.length;i++){var p=d[i],c=r[p];delete r[p];var m=t(c);m===p?n.onRemoved(c):(l[m]=p,n.onChanged(c))}var u=o(e,a);for(i=0;i<u.length;i++)s=u[i],l[s]||n.onAdded(r[s])};return n={subscribe:function(e,t){e.$watch(a,function(e,n){var a=!(t&&t(e,n)===!1);a&&i(e,n)},!0)},onAdded:angular.noop,onChanged:angular.noop,onRemoved:angular.noop}},this.getFullCalendarConfig=function(e,t){var n={};return angular.extend(n,t),angular.extend(n,e),angular.forEach(n,function(e,t){"function"==typeof e&&(n[t]=r(n[t]))}),n},this.getLocaleConfig=function(e){if(!e.lang&&!e.locale||e.useNgLocale){var n=function(e){return(Object.keys(e)||[]).reduce(function(t,n){return t.push(e[n]),t},[])},a=t.DATETIME_FORMATS;return{monthNames:n(a.MONTH),monthNamesShort:n(a.SHORTMONTH),dayNames:n(a.DAY),dayNamesShort:n(a.SHORTDAY)}}return{}}}]).directive("uiCalendar",["uiCalendarConfig",function(e){return{restrict:"A",scope:{eventSources:"=ngModel",calendarWatchEvent:"&"},controller:"uiCalendarCtrl",link:function(t,n,a,o){function r(){var n=a.uiCalendar?t.$parent.$eval(a.uiCalendar):{},r=o.getFullCalendarConfig(n,e),i=o.getLocaleConfig(r);angular.extend(i,r),c={eventSources:s},angular.extend(c,i),c.calendars=null;var l={};for(var d in c)"eventSources"!==d&&(l[d]=c[d]);return JSON.stringify(l)}var i,s=t.eventSources,l=!1,d=o.changeWatcher(s,o.sourceFingerprint),p=o.changeWatcher(o.allEvents,o.eventFingerprint),c=null;t.destroyCalendar=function(){i&&i.fullCalendar&&i.fullCalendar("destroy"),i=a.calendar?e.calendars[a.calendar]=angular.element(n).html(""):angular.element(n).html("")},t.initCalendar=function(){i||(i=$(n).html("")),i.fullCalendar(c),a.calendar&&(e.calendars[a.calendar]=i)},t.$on("$destroy",function(){t.destroyCalendar()}),d.onAdded=function(t){i&&i.fullCalendar&&(i.fullCalendar(c),a.calendar&&(e.calendars[a.calendar]=i),i.fullCalendar("addEventSource",t),l=!0)},d.onRemoved=function(e){i&&i.fullCalendar&&(i.fullCalendar("removeEventSource",e),l=!0)},d.onChanged=function(){i&&i.fullCalendar&&(i.fullCalendar("refetchEvents"),l=!0)},p.onAdded=function(e){i&&i.fullCalendar&&i.fullCalendar("renderEvent",e,!!e.stick)},p.onRemoved=function(e){i&&i.fullCalendar&&i.fullCalendar("removeEvents",e._id)},p.onChanged=function(e){if(i&&i.fullCalendar)for(var t=i.fullCalendar("clientEvents",e._id),n=0;n<t.length;n++){var a=t[n];a=angular.extend(a,e),i.fullCalendar("updateEvent",a)}},d.subscribe(t),p.subscribe(t,function(){return l===!0?(l=!1,!1):void 0}),t.$watch(r,function(e,n){e!==n?(t.destroyCalendar(),t.initCalendar()):e&&angular.isUndefined(i)&&t.initCalendar()})}}}]),angular.module("appoints.config",[]).constant("config",{defaultApiEndpoint:"http://localhost:3000",apiEndpoint:"http://localhost/DocConnectAPI"}).constant("appName","appoints-client").constant("appVersion","0.1.0").constant("appDescription","Doctor appointment scheduler app"),angular.module("appoints.directives",[]),angular.module("appoints.flash",[]).factory("flash",["$rootScope","$timeout",function(e,t){function n(n,a,o){a=a||"info";var i={message:n,level:a,details:o};s.push(i),t(function(){r(i)},5e3),e.$broadcast("event:flash.add",i)}function a(e){e.message?n(e.message,"error",e):n(e,"error")}function o(){return s}function r(t){var n=s.indexOf(t);s.splice(n,1),e.$broadcast("event:flash.remove",t)}function i(){s=[],e.$broadcast("event:flash.clear",!0)}var s=[];return{add:n,addError:a,all:o,remove:r,clear:i}}]).controller("FlashCtrl",["$scope","flash",function(e,t){e.flashMessages=[],e.getMessageClass=function(e){return"error"===e&&(e="danger"),"alert alert-"+e},e.dismiss=function(e){t.remove(e)},e.$on("event:flash.add",function(){e.flashMessages=t.all()}),e.$on("event:flash.remove",function(){e.flashMessages=t.all()}),e.$on("event:flash.clear",function(){e.flashMessages=[],e.$apply()})}]).directive("apHideFlash",["flash",function(e){return{restrict:"A",link:function(t,n){n.bind("click",function(t){var n=angular.element(t.target);n.parents().hasClass("flashcontainer")||e.clear()})}}}]),angular.module("appoints.createappointment",["ngRoute","ui.calendar"]).controller("CreateAppointmentCtrl",["$scope","$compile","usersession","$timeout","$location","uiCalendarConfig","config","$http","_","flash","moment",function(e,t,n,a,o,r,i,s,l,d,p){function c(){e.newAppointment={title:"",dateAndTime:p().startOf("day").add(1,"days").add(9,"hours").toDate(),duration:30,remarks:""},e.editAppointment=null}c(),e.createAppointment=function(){e.newAppointment.patientId=n.current.userId,e.newAppointment.doctorId=e.doctor.DoctorId;var t=i.apiEndpoint+"/appointments",a={method:"POST",url:t,data:e.newAppointment};return s(a).then(function(){d.add("Appointment created successfully","info"),o.url("/dashboard")},function(e){d.add(e.data.ExceptionMessage,"error")})},e.getDoctors=function(){var t={method:"GET",url:i.apiEndpoint+"/doctors"};return s(t).then(function(t){e.doctors=t.data},function(e){d.add(e.data.ExceptionMessage,"error")})},e.getAppointments=function(){e.calEventsExt.events=[];var t=i.apiEndpoint+"/doctors/"+e.doctor.UserDetails.UserId+"/appointments",n={method:"GET",url:t};return s(n).then(function(t){e.eventSources3=l.filter(t.data,function(t){return t.title=t.Title,t.start=p(t.DateAndTime),t.end=p(t.DateAndTime).add(t.Duration,"minutes"),t.allDay=!1,e.addEvent(t),t})},function(e){d.add(e.data.ExceptionMessage,"error")})},e.addEvent=function(t){e.calEventsExt.events.push(t)},e.calEventsExt={events:[]},e.alertOnEventClick=function(t){e.alertMessage=t.title+" was clicked "},e.changeView=function(e,t){r.calendars[t].fullCalendar("changeView",e)},e.renderCalendar=function(e){a(function(){r.calendars[e]&&r.calendars[e].fullCalendar("render")})},e.eventRender=function(n,a){a.attr({tooltip:n.title,"tooltip-append-to-body":!0}),t(a)(e)},e.uiConfig={calendar:{height:450,editable:!1,header:{left:"title",center:"",right:"today prev,next"},eventClick:e.alertOnEventClick,eventDrop:e.alertOnDrop,eventResize:e.alertOnResize,eventRender:e.eventRender}},e.optionChange=function(){e.getAppointments()},e.eventSources=[e.calEventsExt],e.getDoctors()}]),angular.module("appoints.usersession",["appoints.flash","appoints.config"]).factory("usersession",["$rootScope","$window","config","flash","$http","Base64",function(e,t,n,a,o,r){function i(){return angular.copy(c,this)}function s(i){var s={method:"POST",url:n.apiEndpoint+"/login",data:i};return o(s).then(function(n){var a=n.data;a.UserId>0&&(m.isAuthenticated=!0,m.userId=a.UserId,m.displayName=a.DisplayName,m.isAdmin=a.IsAdmin,m.isDoctor=a.IsDoctor,m.authdata=r.encode(i.username+":"+i.password),o.defaults.headers.common.Authorization="Basic "+m.authdata,t.localStorage.setItem("access_token",JSON.stringify(m)),e.$broadcast("event:loggedin",m))},function(e){a.add(e.data.ExceptionMessage,"error")})}function l(e){var t={method:"POST",url:n.apiEndpoint+"/signup",data:e};return o(t).then(function(e){return e},function(e){a.add(e.data.ExceptionMessage,"error")})}function d(e){var t={method:"PUT",url:n.apiEndpoint+"/login",data:e};return o(t).then(function(e){return e},function(e){a.add(e.data.ExceptionMessage,"error")})}function p(){t.localStorage.removeItem("access_token"),m=new i,e.$broadcast("event:loggedout",m)}var c={userId:"",displayName:"",isAuthenticated:!1,isAdmin:!1,isDoctor:!1,authdata:""},m=new i,u="";return{current:m,login:s,signup:l,updatelogindetails:d,logout:p,returnTo:u}}]).run(["$window","$rootScope","usersession","$http",function(e,t,n,a){if(null!==e.localStorage.getItem("access_token")){var o=JSON.parse(e.localStorage.getItem("access_token"));o.userId>0&&(n.current=o,a.defaults.headers.common.Authorization="Basic "+o.authdata,t.$broadcast("event:loggedin",n.current))}}]).factory("Base64",function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return{encode:function(t){var n,a,o,r,i,s="",l="",d="",p=0;do n=t.charCodeAt(p++),a=t.charCodeAt(p++),l=t.charCodeAt(p++),o=n>>2,r=(3&n)<<4|a>>4,i=(15&a)<<2|l>>6,d=63&l,isNaN(a)?i=d=64:isNaN(l)&&(d=64),s=s+e.charAt(o)+e.charAt(r)+e.charAt(i)+e.charAt(d),n=a=l="",o=r=i=d="";while(p<t.length);return s},decode:function(t){var n,a,o,r,i,s="",l="",d="",p=0,c=/[^A-Za-z0-9\+\/\=]/g;c.exec(t)&&window.alert("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding."),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");do o=e.indexOf(t.charAt(p++)),r=e.indexOf(t.charAt(p++)),i=e.indexOf(t.charAt(p++)),d=e.indexOf(t.charAt(p++)),n=o<<2|r>>4,a=(15&r)<<4|i>>2,l=(3&i)<<6|d,s+=String.fromCharCode(n),64!=i&&(s+=String.fromCharCode(a)),64!=d&&(s+=String.fromCharCode(l)),n=a=l="",o=r=i=d="";while(p<t.length);return s}}}),angular.module("appoints.home",["appoints.config","ngRoute"]).controller("HomeCtrl",["$scope","appVersion",function(e,t){e.version=t}]),angular.module("appoints.api",["angular-hal","appoints.config"]).factory("appointsapi",["halClient","config",function(e,t){var n=e.$get(t.defaultApiEndpoint);return{apiRoot:n}}]),angular.module("appoints.dashboard",["appoints.config","appoints.usersession"]).controller("DashboardCtrl",["$scope","$compile","$timeout","uiCalendarConfig","config","usersession","$http","$location","flash","_","moment",function(e,t,n,a,o,r,i,s,l,d,p){e.user=r.current,e.getDoctors=function(){var t={method:"GET",url:o.apiEndpoint+"/doctors"};return i(t).then(function(t){e.doctors=t.data},function(e){l.add(e.data.ExceptionMessage,"error")})},e.getPatients=function(){var t={method:"GET",url:o.apiEndpoint+"/patients"};return i(t).then(function(t){e.patients=t.data},function(e){l.add(e.data.ExceptionMessage,"error")})},e.getAppointments=function(){var t={method:"GET",url:o.apiEndpoint+"/appointments"};return i(t).then(function(t){e.upcomingAdminAppointments=d.filter(t.data,function(e){return p(e.DateAndTime)>p()}),e.pastAdminAppointments=d.filter(t.data,function(e){return p(e.DateAndTime)<=p()})},function(e){l.add(e.data.ExceptionMessage,"error")})},e.getDoctorAppointments=function(){var t={method:"GET",url:o.apiEndpoint+"/doctors/"+r.current.userId+"/appointments"};return i(t).then(function(t){e.upcomingDoctorAppointments=d.filter(t.data,function(e){return e.title=e.Title,e.start=p(e.DateAndTime),e.end=p(e.DateAndTime).add(e.Duration,"minutes"),e.allDay=!1,p(e.DateAndTime)>p()}),e.pastDoctorAppointments=d.filter(t.data,function(t){return t.title=t.Title,t.start=p(t.DateAndTime),t.end=p(t.DateAndTime).add(t.Duration,"minutes"),t.allDay=!1,e.addEventDoc(t),p(t.DateAndTime)<=p()})},function(e){l.add(e.data.ExceptionMessage,"error")})},e.getPatientAppointments=function(){var t={method:"GET",url:o.apiEndpoint+"/patients/"+r.current.userId+"/appointments"};return i(t).then(function(t){e.upcomingPatientAppointments=d.filter(t.data,function(e){return e.title=e.Title,e.start=p(e.DateAndTime),e.end=p(e.DateAndTime).add(e.Duration,"minutes"),e.allDay=!1,p(e.DateAndTime)>p()}),e.pastPatientAppointments=d.filter(t.data,function(t){return t.title=t.Title,t.start=p(t.DateAndTime),t.end=p(t.DateAndTime).add(t.Duration,"minutes"),t.allDay=!1,e.addEventPat(t),p(t.DateAndTime)<=p()})},function(e){l.add(e.data.ExceptionMessage,"error")})},e.deleteAppointment=function(e){var t={method:"DELETE",url:o.apiEndpoint+"/appointments/"+e.AppointmentId};return i(t).then(function(){},function(e){l.add(e.data.ExceptionMessage,"error")})},e.addEvent=function(t){e.calEventsExt.events.push(t)},e.addEventDoc=function(t){e.calEventsDoc.events.push(t)},e.addEventPat=function(t){e.calEventsPat.events.push(t)},e.calEventsExt={events:[]},e.calEventsDoc={events:[]},e.calEventsPat={events:[]},e.eventSources=[e.calEventsExt],e.eventSourceDoctor=[e.calEventsDoc],e.eventSourcePatient=[e.calEventsPat],e.openDoctorDetails=function(e){s.url("/profile/true/true/"+e.UserDetails.UserId)},e.openPatientDetails=function(e){s.url("/profile/true/false/"+e.UserDetails.UserId)},e.openAppointment=function(e){p(e.DateAndTime)<=p()?s.url("/appointment/true/"+e.AppointmentId):s.url("/appointment/false/"+e.AppointmentId)},e.openAppointmentDoctor=function(e){s.url("/profile/true/true/"+e.DoctorUserId)},e.openAppointmentPatient=function(e){s.url("/profile/true/false/"+e.PatientUserId)},r.current.isAdmin?(e.getDoctors(),e.getPatients(),e.getAppointments()):r.current.isDoctor?e.getDoctorAppointments():e.getPatientAppointments(),e.eventClick=function(e){p(e.DateAndTime)<=p()?s.url("/appointment/true/"+e.AppointmentId):s.url("/appointment/false/"+e.AppointmentId)},e.changeView=function(e,t){a.calendars[t].fullCalendar("changeView",e)},e.renderCalendar=function(e){n(function(){a.calendars[e]&&a.calendars[e].fullCalendar("render")})},e.eventRender=function(n,a){a.attr({tooltip:n.title,"tooltip-append-to-body":!0}),t(a)(e)},e.uiConfig={calendar:{height:450,editable:!1,header:{left:"title",center:"",right:"today prev,next"},eventClick:e.eventClick,eventDrop:e.alertOnDrop,eventResize:e.alertOnResize,eventRender:e.eventRender}}}]),angular.module("appoints.logindetails",["appoints.api","appoints.config","appoints.usersession","appoints.flash","ngRoute"]).controller("LoginDetailsCtrl",["$scope","flash","$http","$window","$rootScope","$location","config","usersession",function(e,t,n,a,o,r,i,s){e.updatelogindetails=function(){var n={};n.userId=s.current.userId,n.oldPassword=e.oldPassword,n.newPassword=e.newPassword,s.updatelogindetails(n).then(function(e){e&&(s.returnTo?r.url(s.returnTo):r.url("/"))},function(e){t.add(e.data.ExceptionMessage,"error")})}}]),angular.module("appoints.profile",["appoints.config","appoints.usersession"]).controller("ProfileCtrl",["$scope","$rootScope","$timeout","config","usersession","$http","$location","flash","$routeParams",function(e,t,n,a,o,r,i,s,l){e.isreadonly="true"===l.isreadonly,e.dataLoading=!0,e.maritalStatus={Id:0,Description:""},e.gender={Id:0,Description:""},e.getProfileData=function(){var t=a.apiEndpoint;t=e.isreadonly?"true"===l.isdoctor?t+"/doctors/"+l.userid:t+"/patients/"+l.userid:o.current.isAdmin?t+"/admins/"+o.current.userId:o.current.isDoctor?t+"/doctors/"+o.current.userId:t+"/patients/"+o.current.userId;var n={method:"GET",url:t};return r(n).then(function(t){e.dataLoading=!1,e.profileData=t.data,e.maritalStatus.Id=e.profileData.UserDetails.MaritalStatus,e.gender.Id=e.profileData.UserDetails.Gender},function(e){s.add(e.data.ExceptionMessage,"error")})},e.saveProfileData=function(){var t=a.apiEndpoint;t+=o.current.isAdmin?"/admins":o.current.isDoctor?"/doctors":"/patients",e.profileData.UserDetails.MaritalStatus=e.maritalStatus.Id,e.profileData.UserDetails.Gender=e.gender.Id;var n={method:"PUT",url:t,data:e.profileData};return r(n).then(function(){s.add("Profile saved successfully","info"),i.url("/dashboard")},function(e){s.add(e.data.ExceptionMessage,"error")})},e.getGenderData=function(){var t={method:"GET",url:a.apiEndpoint+"/genders"};return r(t).then(function(t){e.gendersData=t.data},function(e){s.add(e.data.ExceptionMessage,"error")})},e.getMaritalStatusData=function(){var t={method:"GET",url:a.apiEndpoint+"/maritalstatus"};return r(t).then(function(t){e.maritalStatusData=t.data},function(e){s.add(e.data.ExceptionMessage,"error")})},e.goToDashboard=function(){i.url("/dashboard")},e.getProfileData(),e.getGenderData(),e.getMaritalStatusData()}]),angular.module("appoints.signin",["appoints.api","appoints.config","appoints.usersession","appoints.flash","ngRoute"]).controller("UserSigninCtrl",["$scope","flash","$http","$window","$rootScope","$location","config","usersession",function(e,t,n,a,o,r,i,s){e.login=function(){var n={};n.username=e.username,n.password=e.password,s.login(n).then(function(){s.current.isAuthenticated?s.returnTo?r.url(s.returnTo):r.url("/dashboard"):t.add("Invalid username or password.","error")})}}]),angular.module("appoints.signup",["ngRoute","appoints.api"]).controller("UserSignupCtrl",["$scope","usersession","$location",function(e,t,n){e.signupObj={email:"",firstName:"",lastName:"",username:"",password:"",isPractitioner:!1,specialty:"",credentials:""},e.signup=function(){e.signupObj.isPractitioner&&(e.signupObj.firstName="Dr. "+e.signupObj.firstName),t.signup(e.signupObj).then(function(e){var t=e.data;t.UserId>0&&n.url("/usersignin")})}}]),angular.module("appoints",["ngRoute","ui.bootstrap.datetimepicker","appoints.directives","appoints.flash","appoints.usersession","appoints.home","appoints.signin","appoints.logindetails","appoints.signup","appoints.dashboard","appoints.profile","appoints.createappointment","appoints.appointment","appoints-client-templates"]).constant("_",window._).constant("moment",window.moment).config(["$httpProvider",function(e){e.defaults.useXDomain=!0,delete e.defaults.headers.common["X-Requested-With"]}]).config(["$routeProvider",function(e){e.when("/",{templateUrl:"home/home.html",controller:"HomeCtrl",title:"Home"}).when("/appointment/:isreadonly/:appointmentid",{templateUrl:"appointments/appointment.html",controller:"AppointmentCtrl",title:"Appointment"}).when("/usersignin",{templateUrl:"appointments/usersignin.html",controller:"UserSigninCtrl",title:"UserSignin"}).when("/usersignup",{templateUrl:"appointments/usersignup.html",controller:"UserSignupCtrl",title:"UserSignup"}).when("/logindetails",{templateUrl:"appointments/logindetails.html",controller:"LoginDetailsCtrl",title:"LoginDetails"}).when("/dashboard",{templateUrl:"appointments/dashboard.html",controller:"DashboardCtrl",title:"Dashboard"}).when("/createappointment",{templateUrl:"appointments/CreateAppointment.html",controller:"CreateAppointmentCtrl",title:"CreateAppointment"}).when("/profile/:isreadonly/:isdoctor/:userid",{templateUrl:"appointments/profile.html",controller:"ProfileCtrl",title:"Profile"})}]).controller("AppCtrl",["$scope","$location","usersession",function(e,t,n){var a="Appoints";e.pageTitle=a,e.$on("$routeChangeSuccess",function(t,n){e.pageTitle=angular.isUndefined?a:n.title||a}),e.user=n.current,e.routeIs=function(e){return t.path()===e},e.logout=function(){n.logout(),t.url("/")},e.goToDashboard=function(){e.user.isAuthenticated&&t.url("/dashboard")},e.$on("event:loggedin",function(t,a){e.user=a,n.current=a}),e.$on("event:loggedout",function(t,a){e.user=a,n.current=a})}]);